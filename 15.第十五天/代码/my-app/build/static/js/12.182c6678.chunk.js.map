{"version":3,"sources":["pages/rent/rent.jsx"],"names":["roomTypeData","label","value","orientedData","floorData","oSupport","key","sClass","Rent","state","tempSlides","communitylist","community","price","size","roomType","floor","oriented","title","houseImg","supporting","description","sKey","sCurrntCity","store","getState","getValue","name","setState","handleImage","files","fnSetSupport","aNowSupporting","JSON","parse","stringify","includes","filter","item","push","fnShowSearchPannel","fnGetcommunity","a","async","axios","get","params","id","oRes","data","body","fnSetCommunity","fnAddHouse","length","info","oFd","FormData","map","append","file","post","headers","join","sNowsupporting","sNowcommunity","houseRes","status","props","history","this","className","onClick","goBack","communityName","placeholder","extra","onChange","val","cols","Item","arrow","multiple","i","rows","autoHeight","Component"],"mappings":"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","file":"static/js/12.182c6678.chunk.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport \"./rent.css\";\r\nimport store from '../store';\r\n\r\n\r\nimport {\r\n    List,\r\n    InputItem,\r\n    Picker,\r\n    ImagePicker,\r\n    TextareaItem,\r\n    Toast\r\n} from \"antd-mobile\";\r\n\r\n// 房屋类型\r\nconst roomTypeData = [\r\n  { label: \"一室\", value: \"ROOM|d4a692e4-a177-37fd\" },\r\n  { label: \"二室\", value: \"ROOM|d1a00384-5801-d5cd\" },\r\n  { label: \"三室\", value: \"ROOM|20903ae0-c7bc-f2e2\" },\r\n  { label: \"四室\", value: \"ROOM|ce2a5daa-811d-2f49\" },\r\n  { label: \"四室+\", value: \"ROOM|2731c38c-5b19-ff7f\" }\r\n];\r\n\r\n// 朝向：\r\nconst orientedData = [\r\n  { label: \"东\", value: \"ORIEN|141b98bf-1ad0-11e3\" },\r\n  { label: \"西\", value: \"ORIEN|103fb3aa-e8b4-de0e\" },\r\n  { label: \"南\", value: \"ORIEN|61e99445-e95e-7f37\" },\r\n  { label: \"北\", value: \"ORIEN|caa6f80b-b764-c2df\" },\r\n  { label: \"东南\", value: \"ORIEN|dfb1b36b-e0d1-0977\" },\r\n  { label: \"东北\", value: \"ORIEN|67ac2205-7e0f-c057\" },\r\n  { label: \"西南\", value: \"ORIEN|2354e89e-3918-9cef\" },\r\n  { label: \"西北\", value: \"ORIEN|80795f1a-e32f-feb9\" }\r\n];\r\n\r\n// 楼层\r\nconst floorData = [\r\n  { label: \"高楼层\", value: \"FLOOR|1\" },\r\n  { label: \"中楼层\", value: \"FLOOR|2\" },\r\n  { label: \"低楼层\", value: \"FLOOR|3\" }\r\n];\r\n\r\n// 房屋配置\r\nconst oSupport = [\r\n  {key:'衣柜',sClass:'iconfont icon-yigui'},\r\n  {key:'洗衣机',sClass:'iconfont icon-xiyiji'},\r\n  {key:'空调',sClass:'iconfont icon-kongtiao'},\r\n  {key:'天然气',sClass:'iconfont icon-tianranqi'},\r\n  {key:'冰箱',sClass:'iconfont icon-bingxiang'},\r\n  {key:'电视',sClass:'iconfont icon-dianshi'},\r\n  {key:'热水器',sClass:'iconfont icon-reshuiqi'},\r\n  {key:'沙发',sClass:'iconfont icon-shafa'},\r\n  {key:'暖气',sClass:'iconfont icon-nuanqi'},\r\n  {key:'宽带',sClass:'iconfont icon-_huabanfuben'},\r\n]\r\n\r\n/* \r\n  {\r\n      \"title\": \"整租 · 豪华小区 精装修出租 小区环境幽静\",\r\n      \"description\": \"【装修描述】 装修简洁，家电配齐，通风采光效果良好，格局方正。\",\r\n      \"houseImg\": \"img1|im2|img3\",\r\n      \"oriented\": \"ORIEN|caa6f80b-b764-c2df\",\r\n      \"supporting\": \"空调|洗衣机\",\r\n      \"price\": \"1234\",\r\n      \"roomType\": \"ROOM|ce2a5daa-811d-2f49\",\r\n      \"size\": \"123\",\r\n      \"floor\": \"FLOOR|1\",\r\n      \"community\": \"AREA|93cbbe43-741d-de54\"\r\n  }\r\n*/\r\n\r\nclass Rent extends Component {\r\n  state={\r\n    // 临时图片地址\r\n    tempSlides: [],\r\n    // 小区搜索结果\r\n    communitylist:[],\r\n    // 小区的名称和id\r\n    community:{},\r\n    // 价格\r\n    price: '',\r\n    // 面积\r\n    size: '',\r\n    // 房屋类型\r\n    roomType: '',\r\n    // 楼层\r\n    floor: '',\r\n    // 朝向：\r\n    oriented: '',\r\n    // 房屋标题\r\n    title: '',\r\n    // 房屋图片\r\n    houseImg: '',\r\n    // 房屋配套：\r\n    supporting:[],\r\n    // 房屋描述\r\n    description: '',\r\n    // 搜索关键词\r\n    sKey:'',\r\n    // \r\n    sClass:'search_key_pannel',\r\n    // 当前城市\r\n    sCurrntCity:store.getState().value\r\n\r\n  }\r\n\r\n  getValue = (name, value) => {\r\n    this.setState({\r\n      [name]: value\r\n    })\r\n  }\r\n\r\n  handleImage = (files) => {\r\n    this.setState({\r\n      tempSlides: files\r\n    })\r\n  }\r\n\r\n  fnSetSupport=(key)=>{\r\n    this.setState(state=>{\r\n        let aNowSupporting = JSON.parse( JSON.stringify(state.supporting) )\r\n        if(aNowSupporting.includes(key)){\r\n            let aNewArr = aNowSupporting.filter(item=>item!==key);\r\n            return {\r\n                supporting:aNewArr\r\n            }\r\n        }else{\r\n            aNowSupporting.push(key);\r\n            return {\r\n                supporting:aNowSupporting\r\n            }\r\n        }\r\n    })\r\n  }\r\n\r\n  fnShowSearchPannel=()=>{\r\n      this.setState(state=>{\r\n          if( state.sClass==='search_key_pannel' ){\r\n              return {\r\n                sClass:'search_key_pannel search_slide_up'\r\n              }\r\n          }else{\r\n            return {\r\n                sClass:'search_key_pannel'\r\n              }\r\n          }\r\n      })\r\n  }\r\n\r\n  fnGetcommunity= async (key)=>{\r\n      let oRes = await this.axios.get('/area/community',{\r\n          params:{\r\n              name:key,\r\n              id:this.state.sCurrntCity\r\n          }\r\n      });\r\n      //console.log(oRes);\r\n      this.setState({\r\n        communitylist:oRes.data.body\r\n      })\r\n  }\r\n\r\n  fnSetCommunity=(item)=>{\r\n      this.setState({\r\n           community:item\r\n      },()=>{\r\n          this.fnShowSearchPannel()\r\n      })\r\n  }\r\n\r\n  fnAddHouse= async ()=>{\r\n    let {\r\n        tempSlides,\r\n        houseImg,\r\n        title,\r\n        description,\r\n        oriented,\r\n        supporting,\r\n        price,\r\n        roomType,\r\n        size,\r\n        floor,\r\n        community\r\n        } = this.state\r\n\r\n        if (tempSlides.length <= 0){\r\n            Toast.info('请上传房屋图片在发布！',2);\r\n            return;\r\n        }\r\n\r\n        let oFd = new FormData()\r\n\r\n        tempSlides.map(item=>{\r\n            oFd.append('file',item.file)\r\n        })\r\n\r\n        // 上传图片\r\n        let oRes = await this.axios.post('/houses/image',oFd, {\r\n            headers: {\r\n            'content-type': 'multipart/form-data'\r\n            }\r\n        })\r\n\r\n        houseImg = oRes.data.body.join('|');\r\n        let sNowsupporting = this.state.supporting.join('|');\r\n        let sNowcommunity = this.state.community.community;\r\n\r\n       // 发布房源：\r\n        const houseRes = await this.axios.post('/user/houses', {\r\n            houseImg,\r\n            title,\r\n            description,\r\n            oriented,\r\n            supporting:sNowsupporting,\r\n            price,\r\n            roomType,\r\n            size,\r\n            floor,\r\n            community:sNowcommunity\r\n        })\r\n\r\n        const { status } = houseRes.data;\r\n        if(status===200){\r\n            Toast.info('发布房源成功！',2,()=>{\r\n                this.props.history.push('/zlist');\r\n            })\r\n        }\r\n  }\r\n\r\n  render() {\r\n    let {\r\n        community,\r\n        communitylist,\r\n        price,\r\n        roomType,\r\n        floor,\r\n        oriented,\r\n        description,\r\n        tempSlides,\r\n        title,\r\n        size,\r\n        supporting,\r\n        sKey,\r\n        sClass\r\n      } = this.state\r\n\r\n    return (\r\n        <>\r\n        <div className=\"rent_wrap\">\r\n          <div className=\"rent_title\">\r\n              <span className=\"back iconfont icon-prev\" onClick={()=>this.props.history.goBack() }></span>\r\n              <h3>发布房源</h3>\r\n          </div>\r\n          <h3 className=\"rent_sub_title\">房源信息</h3>\r\n          <div className=\"options\">\r\n              <div className=\"select_bar\" onClick={ this.fnShowSearchPannel }><span className=\"fl\">小区名称</span><i className=\"iconfont icon-next fr\"></i><b className=\"fr\">{community.communityName}</b></div>\r\n                <InputItem \r\n                    placeholder=\"请输入租金/月\" \r\n                    extra=\"¥/月\"\r\n                    value={price}\r\n                    onChange={val => this.getValue('price', val)}\r\n                >\r\n                租金\r\n                </InputItem>\r\n                <InputItem \r\n                    placeholder=\"请输入建筑面积\" \r\n                    extra=\"㎡\"\r\n                    value={size}\r\n                    onChange={val => this.getValue('size', val)}\r\n                >\r\n                建筑面积\r\n                </InputItem>\r\n\r\n              <Picker \r\n                 data={roomTypeData}\r\n                 value={[roomType]}\r\n                 cols={1}\r\n                 onChange={val => this.getValue('roomType', val[0])}\r\n              >\r\n                <List.Item arrow=\"horizontal\">户型</List.Item>\r\n              </Picker>\r\n\r\n              <Picker \r\n                  data={floorData}\r\n                  value={[floor]}\r\n                  cols={1}\r\n                  onChange={val => this.getValue('floor', val[0])}\r\n              >\r\n                <List.Item arrow=\"horizontal\">所在楼层</List.Item>\r\n              </Picker>\r\n\r\n              <Picker \r\n                 data={orientedData}\r\n                 value={[oriented]}\r\n                 cols={1}\r\n                 onChange={val => this.getValue('oriented', val[0])}\r\n              >\r\n                <List.Item arrow=\"horizontal\">朝向</List.Item>\r\n              </Picker>\r\n          </div>\r\n          <h3 className=\"rent_sub_title2\">房屋标题</h3>\r\n          <InputItem\r\n            placeholder=\"请输入房屋标题\"\r\n            value={title}\r\n            onChange={val => this.getValue('title', val)}\r\n          />\r\n          <h3 className=\"rent_sub_title2\">房屋图像</h3>\r\n          <ImagePicker\r\n            files={tempSlides}\r\n            multiple={true}\r\n            onChange={this.handleImage}\r\n          />\r\n          <h3 className=\"rent_sub_title2\">房屋配置</h3>\r\n\r\n          <ul className=\"detail_support_list\">\r\n              {\r\n                oSupport.map((item,i)=>(\r\n                    <li \r\n                        key={i} \r\n                        className={ supporting.includes( item.key )?'active':'' }\r\n                        onClick={()=>this.fnSetSupport( item.key ) }\r\n                    >\r\n                        <i className={ item.sClass }></i>\r\n                        <b>{ item.key }</b>\r\n                    </li>\r\n                ))\r\n              }\r\n          </ul>\r\n\r\n          <h3 className=\"rent_sub_title2\">房屋描述</h3>\r\n\r\n          <TextareaItem\r\n            rows={5}\r\n            placeholder=\"请输入房屋描述信息\"\r\n            autoHeight\r\n            value={description}\r\n            onChange={val => this.getValue('description', val)}\r\n          />\r\n\r\n          <div className=\"down_btns\">\r\n              <span>取消</span>\r\n              <b onClick={ this.fnAddHouse }>确定</b>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className={sClass}>\r\n            <div className=\"search_key_header\">\r\n                <div className=\"search_input\">\r\n                    <InputItem placeholder=\"请输入关键词\" value={sKey} onChange={val => this.getValue('sKey', val)}/>\r\n                </div>\r\n                {\r\n                    sKey!==''?(<div className=\"search_btn\" onClick={()=>this.fnGetcommunity( sKey )}>搜索</div>):(<div className=\"search_btn\" onClick={ this.fnShowSearchPannel }>取消</div>)\r\n                }                 \r\n                <ul className=\"search_res_list\">\r\n                    {\r\n                        communitylist.map(item=>(\r\n                            <li key={ item.community } onClick={()=>this.fnSetCommunity(item) }>{item.communityName}</li>\r\n                        ))\r\n                    }\r\n                    \r\n                </ul>\r\n            </div>\r\n        </div>\r\n        </>\r\n    )\r\n  }\r\n}\r\n\r\n\r\nexport default Rent;\r\n"],"sourceRoot":""}